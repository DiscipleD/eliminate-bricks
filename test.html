<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Title</title>
	<script>
		var exampleGrid = (
				"q z J H M z D v H B H A E D G x s C C t H K w y s G K I q L t K D E J w L \n" +
				"K p v r v z C y K M o p D y o y r n \n" +
				"M E w B C p F n M s M J E s u A r J G F L v t r F B H E E D y E x A z F L q s r"
		);
		var exampleString = 'This is a test';

		// should return a decoded message from a grid of characters
		function getDiagonalCode(grid) {
			var gridArray, maxRowLength, step, diagonalCode = [];
			if (!grid) return '';
			gridArray = grid.replace(/ /g, '').split('\n');

			if (gridArray.length === 1) return gridArray[0].charAt(0);

			maxRowLength = 0;
			for (var i = 0; i < gridArray.length; i++) {
				maxRowLength = maxRowLength > gridArray[i].length ? maxRowLength : gridArray[i].length;
			}

			step = (gridArray.length - 1) * 2;
			for (var col = 0, j; col < maxRowLength; col++) {
				j = col % step;
				if (j < gridArray.length) {
					if (gridArray[j].charAt(col)) diagonalCode.push(gridArray[j].charAt(col));
					else break;
				} else {
					if (gridArray[step - j].charAt(col)) diagonalCode.push(gridArray[step - j].charAt(col));
					else break;
				}
			}

			return diagonalCode.join('');
		}

		function toWeirdCase(string){
			//TODO
			var i = 0,
					step = 0,
					s = '';
			while(typeof string[i] != 'undefined') {
				if (string[i] === ' ') {
					step = 0;
					s += string[i];
				} else {
				  s += step % 2 === 0 ? string[i].toUpperCase() : string[i].toLowerCase();
					step++;
				}
				i++;
			}

			return s;
		}

		console.log(getDiagonalCode(exampleGrid));
		console.log(toWeirdCase(exampleString));
	</script>
</head>
<body>
  <canvas id="canvas" width="600" height="400" style="border: 1px solid #000"></canvas>

  <script>
	  var canvas = document.getElementById('canvas');

	  var Game = function() {
		  this.run = false;
	  };

	  var GameFrame = function(canvas, game) {
		  this.canvas = canvas;
		  this.ct = this.canvas.getContext('2d');
		  this.game = game;
	  };
	  GameFrame.prototype.getBoardX = function(x, board) {
		  return x < board.width / 2 ? 0 : x > this.canvas.width - board.width / 2 ? this.canvas.width - board.width : x - board.width / 2;
	  };
	  GameFrame.prototype.clear = function() {
		  // this.ct.fillStyle = 'rgba(255,255,255,0.3)';
		  this.ct.clearRect(0, 0, this.canvas.width, this.canvas.height);
	  };
	  GameFrame.prototype.init = function() {
		  var $this = this;
		  var ref;
		  var ball = new Ball($this.ct);
		  var board = new ControlBoard($this.ct);

		  board.x = ($this.canvas.width - board.width) / 2;
		  board.y = $this.canvas.height - board.height;
		  ball.x = $this.canvas.width / 2;
		  ball.y = board.y - ball.radius;

		  ball.draw();
		  board.draw();

		  $this.canvas.addEventListener('mousemove', function (e) {
			  if ($this.game.run) {

			  } else {
				  $this.clear();
				  board.x = $this.getBoardX(e.clientX, board);
				  ball.x = e.clientX < ball.radius ? ball.radius : e.clientX > $this.canvas.width - ball.radius ? $this.canvas.width - ball.radius : e.clientX;

				  ball.draw();
				  board.draw();
			  }
		  });

		  this.canvas.addEventListener();

		  $this.canvas.addEventListener('mouseout', function() {
			  window.cancelAnimationFrame(ref);
			  $this.game.run = false;
		  });
	  };

	  var Ball = function (ct) {
		  this.ct = ct;
		  this.x = 0;
		  this.y = 0;
		  this.radius = 15;
		  this.color = 'blue';
	  };

	  Ball.prototype.draw = function() {
		  this.ct.beginPath();
		  this.ct.arc(this.x, this.y, this.radius, 0, Math.PI * 2, true);
		  this.ct.closePath();
		  this.ct.fillStyle = this.color;
		  this.ct.fill();
	  };

	  var ControlBoard = function (ct) {
		  this.ct = ct;
		  this.x = 0;
		  this.y = 0;
		  this.width = 150;
		  this.height = 20;
		  this.color = 'brown';
	  };
	  ControlBoard.prototype.draw = function() {
		  this.ct.beginPath();
		  this.ct.fillStyle = this.color;
		  this.ct.fillRect(this.x, this.y, this.width, this.height);
	  };

	  var game = new Game();
	  var gameFrame = new GameFrame(canvas, game);
	  gameFrame.init();
  </script>
</body>
</html>